# OD-20: Create Next.js app structure with layout, routing, and env config

## Notes

I'll analyze the repository structure and create a Next.js app with the required configuration.

<repository_analysis>
Let me first examine the current repository structure to understand what exists and what needs to be created.
</repository_analysis>

<read_file>
<path>.</path>
</read_file>

<read_file>
<path>package.json</path>
</read_file>

<read_file>
<path>next.config.js</path>
</read_file>

<read_file>
<path>next.config.mjs</path>
</read_file>

<read_file>
<path>tsconfig.json</path>
</read_file>

<read_file>
<path>.env.example</path>
</read_file>

<read_file>
<path>.env.local</path>
</read_file>

<read_file>
<path>app</path>
</read_file>

<read_file>
<path>src</path>
</read_file>

Based on my analysis, I'll create a Next.js app structure with:
1. App router configuration
2. Environment variables for Moveware API
3. Base layout with proper TypeScript setup

<write_file>
<path>app/layout.tsx</path>
<content>import type { Metadata } from 'next'
import { Inter } from 'next/font/google'
import './globals.css'

const inter = Inter({ subsets: ['latin'] })

export const metadata: Metadata = {
  title: 'Moveware Dashboard',
  description: 'Dashboard for managing Moveware operations',
}

export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="en">
      <body className={inter.className}>
        <div className="min-h-screen bg-gray-50">
          {children}
        </div>
      </body>
    </html>
  )
}
</content>
</write_file>

<write_file>
<path>app/globals.css</path>
<content>@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --foreground-rgb: 0, 0, 0;
  --background-start-rgb: 214, 219, 220;
  --background-end-rgb: 255, 255, 255;
}

body {
  color: rgb(var(--foreground-rgb));
  background: linear-gradient(
      to bottom,
      transparent,
      rgb(var(--background-end-rgb))
    )
    rgb(var(--background-start-rgb));
}
</content>
</write_file>

<write_file>
<path>app/page.tsx</path>
<content>export default function Home() {
  return (
    <main className="flex min-h-screen flex-col items-center justify-center p-24">
      <div className="z-10 max-w-5xl w-full items-center justify-center font-mono text-sm">
        <h1 className="text-4xl font-bold text-center mb-4">
          Moveware Dashboard
        </h1>
        <p className="text-center text-gray-600">
          Welcome to the Moveware operations dashboard
        </p>
      </div>
    </main>
  )
}
</content>
</write_file>

<write_file>
<path>.env.example</path>
<content># Moveware API Configuration
NEXT_PUBLIC_MOVEWARE_API_URL=https://api.moveware.com
MOVEWARE_API_KEY=your_api_key_here
MOVEWARE_API_SECRET=your_api_secret_here

# Application Configuration
NEXT_PUBLIC_APP_ENV=development
</content>
</write_file>

<write_file>
<path>next.config.mjs</path>
<content>/** @type {import('next').NextConfig} */
const nextConfig = {
  reactStrictMode: true,
  env: {
    MOVEWARE_API_URL: process.env.NEXT_PUBLIC_MOVEWARE_API_URL,
  },
}

export default nextConfig
</content>
</write_file>

<write_file>
<path>lib/env.ts</path>
<content>// Environment variable validation and access
export const env = {
  moveware: {
    apiUrl: process.env.NEXT_PUBLIC_MOVEWARE_API_URL || '',
    apiKey: process.env.MOVEWARE_API_KEY || '',
    apiSecret: process.env.MOVEWARE_API_SECRET || '',
  },
  app: {
    env: process.env.NEXT_PUBLIC_APP_ENV || 'development',
  },
} as const

// Validate required environment variables
export function validateEnv() {
  const required = [
    'NEXT_PUBLIC_MOVEWARE_API_URL',
    'MOVEWARE_API_KEY',
  ]

  const missing = required.filter(key => !process.env[key])

  if (missing.length > 0) {
    throw new Error(
      `Missing required environment variables: ${missing.join(', ')}`
    )
  }
}
</content>
</write_file>

<write_file>
<path>app/api/health/route.ts</path>
<content>import { NextResponse } from 'next/server'

export async function GET() {
  return NextResponse.json({
    status: 'ok',
    timestamp: new Date().toISOString(),
    environment: process.env.NEXT_PUBLIC_APP_ENV || 'development',
  })
}
</content>
</write_file>

<write_file>
<path>tsconfig.json</path>
<content>{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}
</content>
</write_file>

<write_file>
<path>.gitignore</path>
<content># See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# dependencies
/node_modules
/.pnp
.pnp.js
.yarn/install-state.gz

# testing
/coverage

# next.js
/.next/
/out/

# production
/build

# misc
.DS_Store
*.pem

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# local env files
.env*.local
.env

# vercel
.vercel

# typescript
*.tsbuildinfo
next-env.d.ts
</content>
</write_file>

```json
{
  "files_changed": [
    "app/layout.tsx",
    "app/globals.css",
    "app/page.tsx",
    "app/api/health/route.ts",
    ".env.example",
    "next.config.mjs",
    "lib/env.ts",
    "tsconfig.json",
    ".gitignore"
  ],
  "notes": "Created Next.js app structure with:\n\n1. **App Router Setup**: Created app directory with layout.tsx, page.tsx, and globals.css\n2. **Base Layout**: Implemented RootLayout with Inter font, metadata, and minimal styling using Tailwind CSS\n3. **Environment Configuration**: \n   - Created .env.example with Moveware API variables (NEXT_PUBLIC_MOVEWARE_API_URL, MOVEWARE_API_KEY, MOVEWARE_API_SECRET)\n   - Created lib/env.ts for centralized environment variable access and validation\n   - Configured next.config.mjs to expose environment variables\n4. **Routing**: Set up app router structure with a home page and health check API route at /api/health\n5. **TypeScript**: Configured tsconfig.json with strict mode and path aliases\n6. **Git**: Added .gitignore to exclude .env files and build artifacts\n\nNext steps: Copy .env.example to .env.local and fill in actual Moveware API credentials. Run 'npm install' if dependencies are missing."
}
```
